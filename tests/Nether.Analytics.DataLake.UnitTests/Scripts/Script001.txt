DECLARE @YEAR int = 1974; DECLARE @MONTH int = 4;
DECLARE @TEST string = "Hello World!";

DECLARE @MONTH_STR string = (@MONTH < 10) ? String.Concat("0", @MONTH.ToString()) : @MONTH.ToString();
DECLARE @INPUT_FILE string = String.Concat( "/", @YEAR.ToString(), "/", @MONTH_STR, "/{*}/locations.csv");
DECLARE @OUTPUT_FILE string = String.Concat( "/output/locations/monthly/", @YEAR.ToString(), @MONTH_STR, ".csv");

// Read raw location events
@LOCATIONS_RAW =
    EXTRACT type string,
            version string,
            enqueueTime DateTime,
            dequeueTime DateTime,
            clientUtcTime DateTime,
            gameSessionId string,
            lat float,
            lon float,
            geoHash double,
            geoHashPrecision int,
            geoHashCenterlat float,
            geoHashCenterlon float,
            country string,
            district string,
            city string,
            properties string
    FROM @INPUT_FILE
    USING Extractors.Text(delimiter: '|', encoding: Encoding.UTF8, skipFirstNRows: 1);
